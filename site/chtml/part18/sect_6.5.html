<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>6.5 WADO-RS Request/Response</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.18.html" title="PS3.18" />
      <link rel="up" href="chapter_6.html" title="6 Data Communication Requirements" />
      <link rel="prev" href="sect_6.4.html" title="6.4 WADO-WS Request/Response" />
      <link rel="next" href="sect_6.6.html" title="6.6 STOW-RS Request/Response" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">6.5 WADO-RS Request/Response</th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_6.4.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">6 Data Communication Requirements</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_6.6.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both">
                     <a id="sect_6.5" shape="rect"></a>6.5 WADO-RS Request/Response</h2>
               </div>
            </div>
         </div>
         <p>The DICOM RESTful Service defines several action types. An implementation shall support all the following six action types:</p>
         <div class="orderedlist">
            <ol class="orderedlist" type="1">
               <li class="listitem">
                  <p>RetrieveStudy</p>
                  <p>This action retrieves the set of DICOM instances associated with a given study unique identifier (UID). The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
               </li>
               <li class="listitem">
                  <p>RetrieveSeries</p>
                  <p>This action retrieves the set of DICOM instances associated with a given study and series UID. The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
               </li>
               <li class="listitem">
                  <p>RetrieveInstance</p>
                  <p>This action retrieves the DICOM instance associated with the given study, series, and SOP Instance UID. The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
               </li>
               <li class="listitem">
                  <p>RetrieveFrames</p>
                  <p>This action retrieves the DICOM frames for a given study, series, SOP Instance UID, and frame numbers. The response is pixel data, and encapsulated in a multipart MIME response.</p>
               </li>
               <li class="listitem">
                  <p>RetrieveBulkdata</p>
                  <p>This action retrieves the bulk data for a given bulk data URL. The response is a single bulk data item.</p>
               </li>
               <li class="listitem">
                  <p>RetrieveMetadata</p>
                  <p>This action retrieves the DICOM instances presented as the full study metadata with the bulk data removed.</p>
               </li>
            </ol>
         </div>
         <p>DICOM objects returned shall be <a href="../part10/PS3.10.html" class="olink" shape="rect">PS3.10</a> binary objects encoded in a requested Transfer Syntax (Explicit VR Little Endian by default) with one message part per DICOM Instance.</p>
         <p>
        </p>
         <div class="figure">
            <a id="figure_6.5-1" shape="rect"></a>
            <div class="figure-contents">
               <div class="mediaobject">
                  <img src="figures/PS3.18_6.5-1.svg" alt="Mapping between IOD and HTTP message parts" />
               </div>
            </div>
            <p class="title">
               <strong>Figure 6.5-1. Mapping between IOD and HTTP message parts</strong>
            </p>
         </div>
         <p>
            <br class="figure-break" clear="none" />
         </p>
         <p>Other types of responses will be encoded in the following manner: (see <a class="xref" href="sect_6.5.html#figure_6.5-1" title="Figure 6.5-1. Mapping between IOD and HTTP message parts" shape="rect">Figure 6.5-1</a>).</p>
         <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
               <li class="listitem">
                  <p>All XML responses shall be encoded as described in the Native DICOM Model defined in <a href="../part19/PS3.19.html" class="olink" shape="rect">PS3.19</a> with one message part per XML object.</p>
               </li>
               <li class="listitem">
                  <p>All JSON responses shall be encoded as a DICOM JSON Model Object as defined in <a class="xref" href="chapter_F.html" title="F DICOM JSON Model" shape="rect"> Annex F</a>.</p>
               </li>
               <li class="listitem">
                  <p>Uncompressed bulk and pixel data shall be encoded in a Little Endian format using the application/octet-stream media type with one message part per bulk data item.</p>
               </li>
               <li class="listitem">
                  <p>Compressed pixel data may be encoded in one of three ways:</p>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: circle; ">
                        <li class="listitem">
                           <p>Single-frame pixel data encoded using a single-frame media type (one message part)</p>
                        </li>
                        <li class="listitem">
                           <p>Multi-frame pixel data encoded using a single-frame media type (one frame per message part)</p>
                        </li>
                        <li class="listitem">
                           <p>Multi-frame or video pixel data encoded using a multi-frame media type (multiple frames in one message part)</p>
                        </li>
                     </ul>
                  </div>
               </li>
            </ul>
         </div>
         <p>Compressed pixel data shall be encoded using the following Media Types. Media Types corresponding to several DICOM Transfer Syntax UIDs require a transfer-syntax parameter, as shown in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a>, to disambiguate the request.</p>
         <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <h3 class="title">Note</h3>
            <p>If the Transfer Syntax is not specified, then a reversible (lossless) encoding is used.</p>
         </div>
         <div class="table">
            <a id="table_6.5-1" shape="rect"></a>
            <p class="title">
               <strong>Table 6.5-1. Media Type Mapping to Transfer Syntax</strong>
            </p>
            <div class="table-contents">
               <table frame="box" rules="all">
                  <thead>
                     <tr valign="top">
                        <th align="center" rowspan="1" colspan="1">
                           <p>
                              <span class="bold">
                                 <strong>DICOM Transfer Syntax UID</strong>
                              </span>
                           </p>
                        </th>
                        <th align="center" rowspan="1" colspan="1">
                           <p>
                              <span class="bold">
                                 <strong>Media Type and Parameters</strong>
                              </span>
                           </p>
                        </th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr valign="top">
                        <td align="left" colspan="2" rowspan="1">
                           <p>
                              <span class="bold">
                                 <strong>Single-frame media types</strong>
                              </span>
                           </p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.50</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg; transfer-syntax=1.2.840.10008.1.2.4.50</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.51</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg; transfer-syntax=1.2.840.10008.1.2.4.51</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.57</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg; transfer-syntax=1.2.840.10008.1.2.4.57</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.70</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.70</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg; transfer-syntax=1.2.840.10008.1.2.4.70</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.5</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+rle</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.5</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+rle; transfer-syntax=1.2.840.10008.1.2.5</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.80</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg-ls</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.80</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg-ls; transfer-syntax=1.2.840.10008.1.2.4.80</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.81</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpeg-ls; transfer-syntax=1.2.840.10008.1.2.4.81</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.90</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jp2</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.90</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jp2; transfer-syntax=1.2.840.10008.1.2.4.90</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.91</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jp2; transfer-syntax=1.2.840.10008.1.2.4.91</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.92</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.92</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.92</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.93</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.93</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" colspan="2" rowspan="1">
                           <p>
                              <span class="bold">
                                 <strong>Multi-frame media types</strong>
                              </span>
                           </p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.92</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.92</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.92</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.93</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.93</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.100</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>video/mpeg; transfer-syntax=1.2.840.10008.1.2.4.100</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.101</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>video/mpeg; transfer-syntax=1.2.840.10008.1.2.4.101</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.102</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>video/mp4; transfer-syntax=1.2.840.10008.1.2.4.102</p>
                        </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                           <p>1.2.840.10008.1.2.4.103</p>
                        </td>
                        <td align="left" rowspan="1" colspan="1">
                           <p>video/mp4; transfer-syntax=1.2.840.10008.1.2.4.103</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </div>
         <br class="table-break" clear="none" />
         <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <h3 class="title">Note</h3>
            <p>For the media type image/dicom+jp2 Transfer Syntaxes, 1.2.840.10008.1.2.4.90 and 1.2.840.10008.1.2.4.91, the image does not include the jp2 wrapper.</p>
         </div>
         <p>HTTP Request field Accept is used in the header lines by the client in a HTTP protocol transaction to indicate the data responses that are acceptable from the server. HTTP Response fields Content-Type and parameters are used in the header lines by the server in a HTTP protocol transaction to indicate the type and encoding of data returning to the client. All lines are RFC822 format headers. All HTTP header fields whose use is not defined by WADO-RS are presumed to have the meaning defined by the HTTP standard.</p>
         <p>The server is required to support uncompressed bulk and pixel data (application/octet-stream) and must be able to deliver all bulk data in that form unless it is available only in a lossy-compressed format.</p>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.1" shape="rect"></a>6.5.1 WADO-RS - RetrieveStudy</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the set of DICOM instances associated with a given study unique identifier (UID). The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.1.1" shape="rect"></a>6.5.1.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific Services resource to be used for the RetrieveStudy action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{SERVICE}/studies/{StudyInstanceUID}, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{SERVICE} is the base URL for the service. This may be a combination of protocol (either http or https), host, port, and application.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{StudyInstanceUID} is the study instance UID for a single study.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept - A comma-separated list of representation schemes, in preference order, which will be accepted by the service in the response to this request. The types allowed for this request header are as follows:</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/dicom; [transfer-syntax={TransferSyntaxUID}]</p>
                                          <p>Specifies that the response can be DICOM Instances encoded in <a href="../part10/PS3.10.html" class="olink" shape="rect">PS3.10</a> format. If <span class="italic">transfer-syntax</span> is not specified the server can freely choose which Transfer Syntax to use for each Instance.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type=application/octet-stream</p>
                                          <p>Specifies that the response can be Little Endian uncompressed bulk data.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type={MediaType}</p>
                                          <p>Specifies that the response can be pixel data encoded using a {MediaType} listed in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a> (including parameters).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Note</h3>
                  <p>An example of a more complicated accept header with multiple transfer syntaxes:</p>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: none; ">
                        <li class="listitem" style="list-style-type: none">
                           <p>User is interested in receiving JPEG2000 pixel data in lossless or compressed format but is willing to accept JPEG as well.</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: none; ">
                                 <li class="listitem" style="list-style-type: none">
                                    <p>The Accept request would contain the following comma-separated parameters:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: none; ">
                                          <li class="listitem" style="list-style-type: none">
                                             <p>Accept: multipart/related=image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.92,, multipart/related=image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.93, multipart/related=image/dicom+jpeg</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem" style="list-style-type: none">
                                    <p>or alternatively, multiple Accept headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: none; ">
                                          <li class="listitem" style="list-style-type: none">
                                             <p>Accept: multipart/related=image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.92,</p>
                                          </li>
                                          <li class="listitem" style="list-style-type: none">
                                             <p>Accept: multipart/related=image/dicom+jpx; transfer-syntax=1.2.840.10008.1.2.4.93</p>
                                          </li>
                                          <li class="listitem" style="list-style-type: none">
                                             <p>Accept: multipart/related=application/dicom+jpeg</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.1.2" shape="rect"></a>6.5.1.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide the document(s) indicated in the request. In order to parse the bulk data items it is necessary to also retrieve the metadata for the Study.</p>
               <p>The Server shall return the document(s), or an error code when the document(s) cannot be returned. If the server cannot convert all of the data to any of the requested media types/Transfer Syntaxes, then an error code shall be returned, either a "Not Acceptable" response if no data is returned or a "Partial Content" response if only some data is returned.</p>
               <p>The client can compare the SOP Instance UIDs or bulk data URLs in the metadata and the message response to determine which bulk data elements have been returned.</p>
               <p>All response formats have a content type of multipart/related with a message boundary separator. The response format depends on the Accept header specified in the request.</p>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.1.2.1" shape="rect"></a>6.5.1.2.1 DICOM Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/dicom; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains every instance for the specified Study that can be converted to one of the requested Transfer Syntaxes.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the multipart response represents a DICOM SOP Instance with the following http headers:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>Content-Type: application/dicom</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.1.2.2" shape="rect"></a>6.5.1.2.2 Bulk Data Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/octet-stream; boundary={MessageBoundary}</p>
                                 </li>
                                 <li class="listitem">
                                    <p>multipart/related; type={MediaType}; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains all bulk data for the specified Study that can be converted to one of the requested media types.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the response is one of:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>an uncompressed bulk data element encoded in Little Endian binary format with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: application/octet-stream</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed bulk data element from a SOP Instance in the Study encoded in a single-frame compression {MediaType} with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed frame from a multi-frame SOP Instance in the Study encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}/frames/{FrameNumber}</p>
                                             <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                                                <h3 class="title">Note</h3>
                                                <p>Each frame will come in a separate part.</p>
                                             </div>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a set of compressed frames from a SOP Instance in the Study encoded in a multi-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}[/frames/{FrameList}]</p>
                                             <div class="itemizedlist">
                                                <ul class="itemizedlist" style="list-style-type: disc; ">
                                                   <li class="listitem">
                                                      <p>{FrameList} is a list of frames separated by %2C (comma). It may be omitted if the message part includes all frames for the specified bulk pixel data object.</p>
                                                   </li>
                                                </ul>
                                             </div>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.2" shape="rect"></a>6.5.2 WADO-RS - RetrieveSeries</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the set of DICOM instances associated with a given study and series UID. The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.2.1" shape="rect"></a>6.5.2.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific resource to be used for the RetrieveSeries action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{SERVICE}/studies/{StudyInstanceUID}/series/{SeriesInstanceUID}, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{SERVICE} is the base URL for the service. This may be a combination of protocol (either http or https), host, port, and application.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{StudyInstanceUID} is the study instance UID for a single study.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{SeriesInstanceUID} is the series instance UID for a single series.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept - A comma-separated list of representation schemes, in preference order, which will be accepted by the service in the response to this request. The types allowed for this request header are as follows:</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/dicom; [transfer-syntax={TransferSyntaxUID}]</p>
                                          <p>Specifies that the response can be DICOM Instances encoded in <a href="../part10/PS3.10.html" class="olink" shape="rect">PS3.10</a> format. If <span class="italic">transfer-syntax</span> is not specified the server can freely choose which Transfer Syntax to use for each Instance.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type=application/octet-stream;</p>
                                          <p>Specifies that the response can be Little Endian uncompressed bulk data.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type={MediaType}</p>
                                          <p>Specifies that the response can be pixel data encoded using a {MediaType} listed in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a> (including parameters).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.2.2" shape="rect"></a>6.5.2.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide the document(s) indicated in the request. In order to parse the bulk data items it is necessary to also retrieve the metadata for the Study.</p>
               <p>The Server shall return the document(s), or an error code when the document(s) cannot be returned. If the server cannot convert all of the data to any of the requested media types/Transfer Syntaxes, then an error code shall be returned, either a "Not Acceptable" response if no data is returned or a "Partial Content" response if only some data is returned.</p>
               <p>The client can compare the SOP Instance UIDs or bulk data URLs in the metadata and the message response to determine which bulk data elements have been returned.</p>
               <p>All response formats have a content type of multipart/related with a message boundary separator. The response format depends on the Accept header specified in the request.</p>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.2.2.1" shape="rect"></a>6.5.2.2.1 DICOM Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/dicom; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains every instance for the specified Series that can be converted to one of the requested Transfer Syntaxes.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the multipart response represents a DICOM SOP Instance with the following http headers:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>Content-Type: application/dicom</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.2.2.2" shape="rect"></a>6.5.2.2.2 Bulk Data Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type= application/octet-stream; boundary={MessageBoundary}</p>
                                 </li>
                                 <li class="listitem">
                                    <p>multipart/related; type={MediaType}; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains all bulk data for the specified Series that can be converted to one of the requested media types.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the response is one of:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>an uncompressed bulk data element encoded in Little Endian binary format with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: application/octet-stream</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed bulk data element from a SOP Instance in the Series encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed frame from a multi-frame SOP Instance in the Series encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}/frames/{FrameNumber}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a set of compressed frames from a multi-frame SOP Instance in the Series encoded in a multi-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}[/frames/{FrameList}]</p>
                                             <div class="itemizedlist">
                                                <ul class="itemizedlist" style="list-style-type: disc; ">
                                                   <li class="listitem">
                                                      <p>{FrameList} is a list of frames separated by %2C (comma). It may be omitted if the message part includes all frames for the specified bulk pixel data object.</p>
                                                   </li>
                                                </ul>
                                             </div>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.3" shape="rect"></a>6.5.3 WADO-RS - RetrieveInstance</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the DICOM instance associated with the given study, series, and SOP Instance UID. The response can be DICOM or bulk data depending on the "Accept" type, and is encapsulated in a multipart MIME response.</p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.3.1" shape="rect"></a>6.5.3.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific resource to be used for the RetrieveInstance action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{SERVICE}/studies/{StudyInstanceUID}/series/{SeriesInstanceUID}/instances/{SOPInstanceUID}, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{SERVICE} is the base URL for the service. This may be a combination of protocol (either http or https), host, port, and application.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{StudyInstanceUID} is the study instance UID for a single study.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{SeriesInstanceUID} is the series instance UID for a single series.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{SOPInstanceUID} is the SOP Instance UID for a single SOP Instance.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept - A comma-separated list of representation schemes, in preference order, which will be accepted by the service in the response to this request. The types allowed for this request header are as follows:</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/dicom; [transfer-syntax={TransferSyntaxUID}]</p>
                                          <p>Specifies that the response can be DICOM Instances encoded in <a href="../part10/PS3.10.html" class="olink" shape="rect">PS3.10</a> format. If <span class="italic">transfer-syntax</span> is not specified the server can freely choose which Transfer Syntax to use for each Instance.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type=application/octet-stream;</p>
                                          <p>Specifies that the response can be Little Endian uncompressed bulk data.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type={MediaType}</p>
                                          <p>Specifies that the response can be pixel data encoded using a {MediaType} listed in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a> (including parameters).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.3.2" shape="rect"></a>6.5.3.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide either a single DICOM <a href="../part10/PS3.10.html" class="olink" shape="rect">PS3.10</a> object for the SOP Instance or one or more bulk data items. In order to parse the bulk data items it is necessary to also retrieve the metadata for the Study.</p>
               <p>The Server shall return the document(s), or an error code when the document(s) cannot be returned. If the server cannot convert all of the bulk data to any of the requested media types, then an error code shall be returned, either a "Not Acceptable" response if no data is returned or a "Partial Content" response if only some data is returned.</p>
               <p>The client can compare the bulk data URLs in the metadata and the message response to determine which bulk data elements have been returned.</p>
               <p>All response formats have a content type of multipart/related with a message boundary separator. The response format depends on the Accept header specified in the request.</p>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.3.2.1" shape="rect"></a>6.5.3.2.1 DICOM Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/dicom; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The multipart response contains a single item representing the specified DICOM SOP Instance with the following http headers:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>Content-Type: application/dicom</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.3.2.2" shape="rect"></a>6.5.3.2.2 Bulk Data Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/octet-stream; boundary={MessageBoundary}</p>
                                 </li>
                                 <li class="listitem">
                                    <p>multipart/related; type={MediaType}; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains all bulk data for the specified Instance that can be converted to one of the requested media types.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the response is one of:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>an uncompressed bulk data element encoded in Little Endian binary format with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: application/octet-stream</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed bulk data element from a SOP Instance encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed frame from a multi-frame SOP Instance encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}/frames/{FrameNumber}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a set of compressed frames from a multi-frame SOP Instance encoded in a multi-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}[/frames/{FrameList}]</p>
                                             <div class="itemizedlist">
                                                <ul class="itemizedlist" style="list-style-type: disc; ">
                                                   <li class="listitem">
                                                      <p>{FrameList} is a list of frames separated by %2C (comma). It may be omitted if the message part includes all frames for the specified bulk pixel data object.</p>
                                                   </li>
                                                </ul>
                                             </div>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.4" shape="rect"></a>6.5.4 WADO-RS - RetrieveFrames</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the DICOM frames for a given study, series, SOP Instance UID, and frame numbers. The response is pixel data, and is encapsulated in a multipart MIME response.</p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.4.1" shape="rect"></a>6.5.4.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific Services resources to be used for the RetrieveFrames action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{SERVICE}/studies/{StudyInstanceUID}/series/{SeriesInstanceUID}/instances/{SOPInstanceUID}/frames/{FrameList}, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{SERVICE} is the base URL for the service. This may be a combination of protocol (either http or https), host, port, and application.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{StudyInstanceUID} is the study instance UID for a single study.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{SeriesInstanceUID} is the series instance UID for a single series.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{SOPInstanceUID} is the SOP Instance UID for a single SOP Instance.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{FrameList} is a comma or %2C separated list of one or more non duplicate frame numbers. These may be in any order (e.g., ../frames/1,2,4,3).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/octet-stream</p>
                                          <p>Specifies that the response can be Little Endian uncompressed pixel data</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type={MediaType}</p>
                                          <p>Specifies that the response can be pixel data encoded using a {MediaType} and {TransferSyntaxUID} listed in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a> (including parameters).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.4.2" shape="rect"></a>6.5.4.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide the document(s) indicated in the request. In order to parse the bulk data items it is necessary to also retrieve the metadata for the Study.</p>
               <p>The Server shall return the document(s) or an error code when the document(s) cannot be returned. If the server cannot encode the pixel data using any of the requested media types, then an error status shall be returned.</p>
               <p>All response formats has a content type of multipart/related with a message boundary separator.</p>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.4.2.1" shape="rect"></a>6.5.4.2.1 Pixel Data Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/octet-stream; boundary={MessageBoundary}</p>
                                 </li>
                                 <li class="listitem">
                                    <p>multipart/related; type={MediaType}; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains all requested Frames for the specified Instance.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the response is one of:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>an uncompressed frame encoded in Little Endian binary format with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: application/octet-stream</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}[/frames/{FrameNumber}]</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed frame encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}/frames/{FrameNumber}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a set of compressed frames encoded in a multi-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}[/frames/{FrameList}]</p>
                                             <div class="itemizedlist">
                                                <ul class="itemizedlist" style="list-style-type: disc; ">
                                                   <li class="listitem">
                                                      <p>{FrameList} is a list of frames separated by %2C (comma). It may be omitted if the message part includes all frames for the specified bulk pixel data object.</p>
                                                   </li>
                                                </ul>
                                             </div>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The frames will be returned in the order specified by the Frame List.</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.5" shape="rect"></a>6.5.5 WADO-RS - RetrieveBulkdata</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the bulk data for a given bulk data URL. The response is a single bulk data item.</p>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.5.1" shape="rect"></a>6.5.5.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific Services resource to be used for the RetrieveBulkdata action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{BulkDataURL}, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{BulkDataURL} is the URL of a bulk data element. This may be the URL attribute of a BulkData element received in response to a WADO-RS RetrieveMetadataRequest.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>The server shall always return the same bulk data for a specified BulkData URL if the data is available.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>If the resource specified by the BulkData URL is not available, the server shall return:</p>
                                          <div class="itemizedlist">
                                             <ul class="itemizedlist" style="list-style-type: disc; ">
                                                <li class="listitem">
                                                   <p>404 - Not Found, if the server expects to be able to return the resource again in the future</p>
                                                </li>
                                                <li class="listitem">
                                                   <p>410 - Gone, if the server does not expect the resource to be valid in the future</p>
                                                </li>
                                             </ul>
                                          </div>
                                       </li>
                                       <li class="listitem">
                                          <p>The server determines the period of time a BulkData URL resource is available.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/octet-stream</p>
                                          <p>Specifies that the response can be Little Endian uncompressed bulk data.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>multipart/related; type={MediaType}</p>
                                          <p>Specifies that the response can be pixel data encoded using a {MediaType} listed in <a class="xref" href="sect_6.5.html#table_6.5-1" title="Table 6.5-1. Media Type Mapping to Transfer Syntax" shape="rect">Table 6.5-1</a> (including parameters).</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                              <li class="listitem">
                                 <p>Range</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>See RFC 2616 Section 14.35. If omitted in the request the server shall return the entire bulk data object.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.5.2" shape="rect"></a>6.5.5.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide the document(s) indicated in the request. In order to parse the bulk data items it is necessary to also retrieve the metadata for the Study.</p>
               <p>The Server shall return the document(s) or an error code when the document(s) cannot be returned. If the server cannot encode the pixel data using any of the requested media types, then an error status shall be returned.</p>
               <p>All response formats have a content type of multipart/related with a message boundary separator. The response format depends on the Accept header specified in the request.</p>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.5.2.1" shape="rect"></a>6.5.5.2.1 Bulk Data Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/octet-stream; boundary={MessageBoundary}</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The single item in the response is one of:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>an uncompressed bulk data element encoded in Little Endian binary format with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: application/octet-stream</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                                 <li class="listitem">
                                    <p>a compressed bulk data element from a SOP Instance encoded in a single-frame media type with the following headers:</p>
                                    <div class="itemizedlist">
                                       <ul class="itemizedlist" style="list-style-type: square; ">
                                          <li class="listitem">
                                             <p>Content-Type: {MediaType}</p>
                                          </li>
                                          <li class="listitem">
                                             <p>Content-Location: {BulkDataURL}</p>
                                          </li>
                                       </ul>
                                    </div>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>If the Range header is specified in the request, the server shall return only the specified bytes of the bulk data object. See RFC 2616 Section 14.35.</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.6" shape="rect"></a>6.5.6 WADO-RS - RetrieveMetadata</h3>
                  </div>
               </div>
            </div>
            <p>This action retrieves the DICOM instances presented as the full study metadata with the bulk data removed. The response is metadata for the DICOM attributes.</p>
            <p>The full study metadata includes all attributes of the study; however, a RESTful Service is permitted to replace the Value Field of an attribute with a BulkDataURL for attributes with Value Representations (VR) of FL, FD, IS, LT, OB, OD, OF, OW, SL, SS, ST, UL, UN, US, and UT. The client can use the BulkDataURL with the RetrieveBulkData action to retrieve the original Value Field of that attribute.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        <p>The server is not required to replace any attribute with a BulkDataURL; this is intended to allow the server to provide clients with metadata of a reasonably small size by leaving out large data Value Fields.</p>
                     </li>
                     <li class="listitem">
                        <p>Attributes with binary Value Fields are encoded as XML Base64 binary values.</p>
                     </li>
                     <li class="listitem">
                        <p>Some DICOM instances, such as SR documents, may be entirely described in the metadata.</p>
                     </li>
                  </ol>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.6.1" shape="rect"></a>6.5.6.1 Request</h4>
                     </div>
                  </div>
               </div>
               <p>The specific Services resource to be used for the RetrieveMetadata action shall be as follows:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>Resource</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>{SERVICE}/studies/{StudyInstanceUID}/metadata, where</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>{SERVICE} is the base URL for the service. This may be a combination of protocol (either http or https), host, port, and application.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>{StudyInstanceUID} is the study instance UID for a single study.</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Method</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>GET</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>Headers</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: circle; ">
                              <li class="listitem">
                                 <p>Accept</p>
                                 <div class="itemizedlist">
                                    <ul class="itemizedlist" style="list-style-type: square; ">
                                       <li class="listitem">
                                          <p>multipart/related; type=application/dicom+xml</p>
                                          <p>Specifies that the response should be <a href="../part19/PS3.19.html" class="olink" shape="rect">PS3.19</a> XML. All WADO-RS providers must support this Media Type.</p>
                                       </li>
                                       <li class="listitem">
                                          <p>application/json</p>
                                          <p>Specifies that the results should be DICOM JSON (see <a class="xref" href="chapter_F.html" title="F DICOM JSON Model" shape="rect"> Annex F</a>). A WADO-RS provider may optionally support this Media Type</p>
                                       </li>
                                    </ul>
                                 </div>
                              </li>
                           </ul>
                        </div>
                     </li>
                  </ul>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title">
                           <a id="sect_6.5.6.2" shape="rect"></a>6.5.6.2 Response</h4>
                     </div>
                  </div>
               </div>
               <p>The Server shall provide the document(s) indicated in the request. The Server shall return the document(s) or an error code when the document(s) could not be returned.</p>
               <p>The response has a content type of either:</p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem">
                        <p>multipart/related; type=application/dicom+xml, as described in the Native DICOM Model defined in <a href="../part19/PS3.19.html" class="olink" shape="rect">PS3.19</a>, or</p>
                     </li>
                     <li class="listitem">
                        <p>application/json, as described in <a class="xref" href="chapter_F.html" title="F DICOM JSON Model" shape="rect"> Annex F</a>.</p>
                     </li>
                  </ul>
               </div>
               <p>The response must include the URL attribute for each BulkData element.</p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Note</h3>
                  <p>The metadata is consistent with the characteristics of the bulk data on the server. If bulk data is requested using specified Transfer Syntaxes or media types, it is possible that the bulk data retrieved may be inconsistent with the metadata. For example, for a Study whose DICOM Tag (0028,2110) "LossyImageCompression" is set to "00", indicating no lossy compression, calling RetrieveStudy and requesting a lossy compression media type will provide pixel data that is inconsistent with the metadata. It is the responsibility of the client to deal with these inconsistencies appropriately.</p>
               </div>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.6.2.1" shape="rect"></a>6.5.6.2.1 XML Metadata Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>multipart/related; type=application/dicom+xml</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The entire multipart response contains all XML metadata for the specified Study.</p>
                        </li>
                        <li class="listitem">
                           <p>Each item in the response is the XML encoded metadata for an Instance with the following http headers:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>Content-Type: application/dicom+xml; transfer-syntax={TransferSyntaxUID}</p>
                                    <p>Where {TransferSyntaxUID} is the UID of the DICOM Transfer Syntax used to encode the inline binary data in the XML metadata.</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                     </ul>
                  </div>
               </div>
               <div class="section">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h5 class="title">
                              <a id="sect_6.5.6.2.2" shape="rect"></a>6.5.6.2.2 JSON Metadata Response</h5>
                        </div>
                     </div>
                  </div>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: disc; ">
                        <li class="listitem">
                           <p>Content-Type:</p>
                           <div class="itemizedlist">
                              <ul class="itemizedlist" style="list-style-type: circle; ">
                                 <li class="listitem">
                                    <p>application/json; transfer-syntax={TransferSyntaxUID}</p>
                                    <p>Where {TransferSyntaxUID} is the UID of the DICOM Transfer Syntax used to encode the inline binary data in the XML metadata.</p>
                                 </li>
                              </ul>
                           </div>
                        </li>
                        <li class="listitem">
                           <p>The response is a JSON array that contains all metadata for the specified Study.</p>
                        </li>
                        <li class="listitem">
                           <p>Each element in the array is the DICOM JSON encoded metadata for an Instance (see <a class="xref" href="chapter_F.html" title="F DICOM JSON Model" shape="rect"> Annex F</a>).</p>
                        </li>
                     </ul>
                  </div>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.5.7" shape="rect"></a>6.5.7 Error Codes</h3>
                  </div>
               </div>
            </div>
            <p>The following error codes are defined and shall be used to report any of the associated error and warning situations. Other error codes may be present for other error and warning situations.</p>
            <div class="table">
               <a id="table_6.5-2" shape="rect"></a>
               <p class="title">
                  <strong>Table 6.5-2. Error Codes</strong>
               </p>
               <div class="table-contents">
                  <table frame="box" rules="all">
                     <thead>
                        <tr valign="top">
                           <th align="center" rowspan="1" colspan="1">
                              <p>
                                 <span class="bold">
                                    <strong>Client Error Code</strong>
                                 </span>
                              </p>
                           </th>
                           <th align="center" rowspan="1" colspan="1">
                              <p>
                                 <span class="bold">
                                    <strong>Client Error Name</strong>
                                 </span>
                              </p>
                           </th>
                           <th align="center" rowspan="1" colspan="1">
                              <p>
                                 <span class="bold">
                                    <strong>Error Situation</strong>
                                 </span>
                              </p>
                           </th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>206</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Partial Content</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Accept type, Transfer Syntax or decompression method supported for some but not all requested content.</p>
                           </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>400</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Bad Request</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Malformed resource</p>
                           </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>404</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Not Found</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Specified resource does not exist</p>
                           </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>406</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Not Acceptable</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Accept type, Transfer Syntax or decompression method not supported</p>
                           </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>410</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Gone</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Specified resource was deleted</p>
                           </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                              <p>503</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Busy</p>
                           </td>
                           <td align="left" rowspan="1" colspan="1">
                              <p>Service is unavailable</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <br class="table-break" clear="none" />
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_6.4.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="chapter_6.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_6.6.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">6.4 WADO-WS Request/Response </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.18.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> 6.6 STOW-RS Request/Response</td>
            </tr>
         </table>
      </div>
   </body>
</html>
