<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>6.3 DICOM Message Structure and Command Set</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.7.html" title="PS3.7" />
      <link rel="up" href="chapter_6.html" title="6 Service Context" />
      <link rel="prev" href="sect_6.2.html" title="6.2 The DICOM Application Layer Structure" />
      <link rel="next" href="chapter_7.html" title="7 Service Overview" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">6.3 DICOM Message Structure and Command Set</th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_6.2.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">6 Service Context</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="chapter_7.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both">
                     <a id="sect_6.3" shape="rect"></a>6.3 DICOM Message Structure and Command Set</h2>
               </div>
            </div>
         </div>
         <p>Information is communicated across the DICOM network interface in a DICOM Message. A Message is composed of a Command Set followed by a conditional Data Set (see <a href="../part05/PS3.5.html" class="olink" shape="rect">PS3.5</a> for the definition of a Data Set). The Command Set is used to indicate the operations/notifications to be performed on or with the Data Set.</p>
         <p>A Command Set is constructed of Command Elements. Command Elements contain the encoded values for each individual field of the Command Set per the semantics specified in the DIMSE protocol (see <a class="xref" href="sect_9.2.html" title="9.2 Sequencing" shape="rect">Section 9.2</a> and <a class="xref" href="sect_10.2.html" title="10.2 Sequencing" shape="rect">Section 10.2</a>). Each Command Element is composed of an explicit Tag, a Value Length, and a Value Field.</p>
         <p>The overall structure of a DICOM Message is shown in <a class="xref" href="sect_6.3.html#figure_6.3-1" title="Figure 6.3-1. DICOM Message Structure" shape="rect">Figure 6.3-1</a>.</p>
         <p>
</p>
         <div class="figure">
            <a id="figure_6.3-1" shape="rect"></a>
            <div class="figure-contents">
               <div class="mediaobject">
                  <img src="figures/PS3.7_6.3-1.svg" alt="DICOM Message Structure" />
               </div>
            </div>
            <p class="title">
               <strong>Figure 6.3-1. DICOM Message Structure</strong>
            </p>
         </div>
         <p>
            <br class="figure-break" clear="none" />
         </p>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title">
                        <a id="sect_6.3.1" shape="rect"></a>6.3.1 Command Set Structure</h3>
                  </div>
               </div>
            </div>
            <p>The Command Elements in a Command Set shall be ordered by increasing Command Element Tag number. A Command Element Tag uniquely identifies a Command Element and shall occur at most once in a Command Set. The encoding of the Command Set shall be Little Endian Byte Ordering as defined in <a href="../part05/PS3.5.html" class="olink" shape="rect">PS3.5</a>. The requirements for the existence of a Command Element in a Command Set are defined in the DIMSE protocol.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        <p>The use of Private Command Elements has been retired in this version of the DICOM Standard.</p>
                     </li>
                     <li class="listitem">
                        <p>The encoding corresponds to the Implicit VR Data Element encoding defined in <a href="../part05/PS3.5.html" class="olink" shape="rect">PS3.5</a>.</p>
                     </li>
                  </ol>
               </div>
            </div>
            <p>A Command Element is composed of three fields; a Command Element Tag, a Value Length, and a Value Field.</p>
            <p>Command Element Tag: An ordered pair of 16-bit unsigned integers representing the Group Number followed by Element Number.</p>
            <p>Value Length: A 32-bit unsigned integer representing the explicit Length as the number of bytes (even) that make up the Value. It does not include the length of the Command Element Tag or Value Length fields.</p>
            <p>Value Field: An even number of bytes containing the Value(s) of the Command Element.</p>
            <p>The command type of Value(s) stored in this field is specified by the Command Element's Value Representation (VR). The VR for a given Command Element can be determined using the Command Dictionary in <a class="xref" href="chapter_E.html" title="E Command Dictionary (Normative)" shape="rect"> Annex E</a>. The VR of Command Elements shall agree with those specified in the Command Dictionary. The VR definitions are defined in <a href="../part05/PS3.5.html" class="olink" shape="rect">PS3.5</a>
            </p>
            <p>The Value Multiplicity (VM) specifies how many Values with the VR can be placed in the Value Field. If the VM is greater than one, multiple Values shall be delimited within the Value Field as defined in <a href="../part05/PS3.5.html" class="olink" shape="rect">PS3.5</a>. The VM for a given Command Element can be determined using the Command Dictionary in <a class="xref" href="chapter_E.html" title="E Command Dictionary (Normative)" shape="rect"> Annex E</a>.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        <p>The Message Length-to-End (0000,0001) Command Element is retired. Implementations may choose to send it for backward compatibility reasons. DICOM V3.0 conformant implementations must not rely on its presence for their operation.</p>
                     </li>
                     <li class="listitem">
                        <p>The delimitation of the Message length is actually achieved by relying on the fact that the Presentation Data Value (conveying each Message fragment) is delimited as defined by the OSI Upper Layer Service and the associated Message Control Header (see <a href="../part08/PS3.8.html" class="olink" shape="rect">PS3.8</a>). This results from the fact that the DICOM V3.0 UL protocol or the OSI Presentation protocol explicitly conveys the length of a PDV.</p>
                     </li>
                  </ol>
               </div>
            </div>
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_6.2.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="chapter_6.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="chapter_7.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">6.2 The DICOM Application Layer Structure </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.7.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> 7 Service Overview</td>
            </tr>
         </table>
      </div>
   </body>
</html>
